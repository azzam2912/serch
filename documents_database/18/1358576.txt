depending on the sources spanish troops numbered between 12 000 and 25 000 british defenders were 1 500 at the beginning of the siege increasing up to about 5 000 after a five month siege with several unsuccessful and costly assaults spanish troops gave up and withdrew following the failure the war drew to a close opening the way for the 1728 treaty of el pardo and the treaty of seville signed in 1729 on 1 january 1727 n s the marquis of pozobueno spanish ambassador to the court of st james s sent a letter to the duke of newcastle explaining why the spanish crown believed that article x of the treaty of utrecht the article which granted britain perpetual control of gibraltar under certain conditions had been nullified by infractions by the british the letter was tantamount to a declaration of war spain however was not in a particularly advantageous position to capture gibraltar in 1727 at the last attempt to retake gibraltar in 1704 spain had a strong navy and the additional assistance of french warships however following their defeat at the battle of cape passaro and the capture of vigo and pasajes the spanish navy was