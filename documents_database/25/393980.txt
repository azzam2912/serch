the resulting digest or fingerprint is then encrypted to hide the identity of the hash function used as with any mac it may be used to simultaneously verify both the data integrity and the authenticity of a message umac is specified in rfc 4418 it has provable cryptographic strength and is usually a lot less computationally intensive than other macs umac s design is optimized for 32 bit architectures a closely related variant of umac that is optimized for 64 bit architectures is given by vmac let s say the hash function is chosen from a class of hash functions h which maps messages into d the set of possible message digests this class is called universal if for any distinct pair of messages there are at most h d functions that map them to the same member of d this means that if an attacker wants to replace one message with another and from his point of view the hash function was chosen completely randomly the probability that the umac will not detect his modification is at most 1 d but this definition is not strong enough if the possible messages are 0 and 1 d 0 1 and