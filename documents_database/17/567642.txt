it is applicable for both linear and non linear material behaviours as well as for systems subject to environmental effects and hence more general than castigliano s second theorem consider a discrete system such as trusses beams or frames having members interconnected at the nodes let the consistent set of members deformations be given by formula 1 which can be computed using the member flexibility relation these member deformations give rise to the nodal displacements formula 2 which we want to determine we start by applying n virtual nodal forces formula 3 one for each wanted r and find the virtual member forces formula 4 that are in equilibrium with formula 3 in the case of a statically indeterminate system matrix b is not unique because the set of formula 4 that satisfies nodal equilibrium is infinite it can be computed as the inverse of the nodal equilibrium matrix of any primary system derived from the original system imagine that internal and external virtual forces undergo respectively the real deformations and displacements the virtual work done can be expressed as according to the virtual work principle the two work expressions are equal substitution of 1 gives since formula 12 contains