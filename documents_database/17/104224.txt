he was the third but only surviving son of afonso iv of portugal and his wife beatrice of castile in 1328 peter s father afonso iv arranged for the marriage of his eldest daughter maria to alfonso xi of castile in 1334 she bore him a son who ultimately became peter of castile however maria returned home to her father in portugal in 1335 because her royal husband soon after their marriage had begun a long affair with the beautiful and newly widowed leonor de guzman which the castilian king refused to end alfonso s cousin juan manuel prince of villena had been rebuffed by the castilian king in 1327 when the two year child marriage between his daughter constanza granddaughter of james ii of aragon and alfonso had been annulled to clear the way for the marriage to maria for two years juan manuel had waged war against the castilians who had kept constanza hostage until bishop john del campo of oviedo mediated a peace in 1329 enraged by alfonso s infidelity and mistreatment of his lawful wife her father made a new alliance with the powerful castilian aristocrat afonso married his son and heir peter to constanza thereby