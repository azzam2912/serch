the algorithm is believed to work well on random sparse graphs and is particularly suitable for graphs that contain negative weight edges however the worst case complexity of spfa is the same as that of bellman ford so for graphs with nonnegative edge weights dijkstra s algorithm is preferred the spfa algorithm was first published by edward f moore in 1959 as a generalization of breadth first search the same algorithm was rediscovered in 1994 by fanding duan given a weighted directed graph formula 1 and a source vertex formula 2 the spfa algorithm finds the shortest path from formula 2 to each vertex formula 4 in the graph the length of the shortest path from formula 2 to formula 4 is stored in formula 7 for each vertex formula 4 the basic idea of spfa is the same as bellman ford algorithm in that each vertex is used as a candidate to relax its adjacent vertices the improvement over the latter is that instead of trying all vertices blindly spfa maintains a queue of candidate vertices and adds a vertex to the queue only if that vertex is relaxed this process repeats until no more vertex can be relaxed