it is loosely based on the molly maguires and pinkerton agent james mcparland the story was first published in the strand magazine between september 1914 and may 1915 the first book edition was copyrighted in 1914 and it was first published by george h doran company in new york on 27 february 1915 and illustrated by arthur i keller the novel starts with sherlock holmes receiving a cipher message from fred porlock a pseudonymous agent of professor moriarty after porlock sends the message however he changes his mind for fear of moriarty s discovering that he is a traitor he decides not to send the key to the cipher but he sends holmes a note telling of this decision from the cipher message and the second note holmes is able to deduce that it is a book cipher and that the book used for the encryption is a common book large with at least 534 pages printed in two columns per page and standardised an almanac fits these conditions exactly holmes tries the latest edition of whitaker s almanac which he had only received a few days earlier and fails he then tries the previous edition with this almanac holmes