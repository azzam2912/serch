he transferred to the royal flying corps on 30 november 1917 he served as an airco dh 4 pilot in no 57 squadron rfc until he was appointed a flight commander with a temporary rank of captain on 1 may 1918 from 31 july to 5 september 1918 macgregor was credited with six aerial victories macgregor was released from duty on 23 may 1919 however on 1 august 1919 he was given a commission in the royal air force although as a lieutenant instead of captain he would serve as a pilot in iraq kurdistan and egypt until 12 june 1924 on that date he began staff duties as a military intelligence officer at hq iraq macgregor began study at the royal air force staff college on 19 september 1927 after that his career upwards began as he rotated through increasingly responsible positions on 1 september 1938 he was appointed assistant director deputy directorate of war organisation on 19 november 1940 macgregor was posted as senior air staff officer to headquarters no 4 bomber group on 1 march 1943 he was assigned to north west african air forces macgregor moved to air staff mediterranean allied air forces on 29 january