it is commonly used to estimate the power transfer between input and output of a linear system if the signals are ergodic and the system function is linear it can be used to estimate the causality between the input and output the coherence sometimes called magnitude squared coherence between two signals x t and y t is a real valued function that is defined as where g f is the cross spectral density between x and y and g f and g f the autospectral density of x and y respectively the magnitude of the spectral density is denoted as g given the restrictions noted above ergodicity linearity the coherence function estimates the extent to which y t may be predicted from x t by an optimum linear least squares function values of coherence will always satisfy formula 2 for an ideal constant parameter linear system with a single input x t and single output y t the coherence will be equal to one to see this consider a linear system with an impulse response h t defined as formula 3 where denotes convolution in the fourier domain this equation becomes formula 4 where y f is the fourier transform