given integers p and q where p 0 and formula 1 let u p q and v p q be the corresponding lucas sequences let n be a positive integer and let formula 2 be the jacobi symbol we define if n is a prime such that the greatest common divisor of n and q that is gcd n q is 1 then the following congruence condition holds if this equation does not hold then n is not prime if n is composite then this equation usually does not hold these are the key facts that make lucas sequences useful in primality testing some good references are chapter 8 of the book by bressoud and wagon with mathematica code pages 142 152 of the book by crandall and pomerance and pages 53 74 of the book by ribenboim a lucas probable prime for a given p q pair is any positive integer n for which equation above is true see page 1398 a lucas pseudoprime for a given p q pair is a positive composite integer n for which equation is true see page 1391 a lucas probable prime test is most useful if d is chosen such that the