it was introduced by mitsuru matsui 1993 as an analytical tool for linear cryptanalysis the piling up lemma allows the cryptanalyst to determine the probability that the equality holds where the x s are binary variables that is bits either 0 or 1 let p a denote the probability that a is true if it equals one a is certain to happen and if it equals zero a cannot happen first of all we consider the piling up lemma for two binary variables where formula 2 and formula 3 now we consider due to the properties of the xor operation this is equivalent to x x 0 and x x 1 are mutually exclusive events so we can say now we must make the central assumption of the piling up lemma the binary variables we are dealing with are independent that is the state of one has no effect on the state of any of the others thus we can expand the probability function as follows now we express the probabilities p and p as and where the s are the probability biases the amount the probability deviates from thus the probability bias for the xor sum above is 2