it is based on meyer s 1974 novel of the same name and stars nicol williamson robert duvall alan arkin and laurence olivier dr john h watson robert duvall becomes convinced that his friend sherlock holmes nicol williamson is delusional particularly in his belief that professor james moriarty laurence olivier is a criminal mastermind as a result of his addiction to cocaine moriarty visits watson to complain about being harassed by holmes watson enlists the aid of sherlock s brother mycroft charles gray to trick holmes into traveling to vienna where he will be treated by sigmund freud alan arkin during the course of his treatment holmes investigates a kidnapping case with international implications and freud uncovers a dark personal secret suppressed in holmes s subconscious the film was made at pinewood studios with location shooting in the uk and austria including the austrian national library the tennis match duel between freud and von leinsdorf was filmed on one of the historic real tennis courts at the queen s club in west kensington london the production designer was ken adam stephen sondheim wrote a song for the movie the madame s song that was later recorded as i never do