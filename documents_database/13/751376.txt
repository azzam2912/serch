in win32 programs microsoft recommends its use anywhere random number generation is needed a 2007 paper from hebrew university suggested security problems in the windows 2000 implementation of cryptgenrandom assuming the attacker has control of the machine microsoft later acknowledged that the same problems exist in windows xp but not in vista microsoft released a fix for the bug with windows xp service pack 3 in mid 2008 the win32 api includes comprehensive support for cryptographic security including native tls support via the schannel api and code signing these capabilities are built on native windows libraries for cryptographic operations such as rsa and aes key generation these libraries in turn rely on a cryptographically secure pseudorandom number generator csprng cryptgenrandom is the standard csprng for the win32 programming environment microsoft provided cryptography providers share the same implementation of cryptgenrandom currently based on an internal function called rtlgenrandom only a general outline of the algorithm had been published rtlgenrandom generates as specified in fips 186 2 appendix 3 1 with sha 1 as the g function and with entropy from omitted long lists of low level system information fields and performance counters the security of a cryptosystem s csprng is significant