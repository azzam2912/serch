in particular a cycle of 18 texts studied by amoghavajra which included both tattvasa graha tantra and the guhyasamaja tantra a tibetan text which appears to be composed of two works grouped together and to further confuse matters in the japanese shingon school the is known by this name in tibetan it is considered to be the main representative of the yogatantra class of texts the sutra begins with vairocana buddha preaching the dharma to a great host of bodhisattvas including vajrasattva in the buddhist heaven of akanishta as he preaches the dharma prince sarvarthasiddhi the esoteric name of the buddha siddhartha gautama is meditating under the bodhi tree enlightenment is imminent but the prince has still not attained it because he is still attached in some small way to his forsaken ascetic practices despairing over his inability to find enlightenment he is visited by buddhist figures who were just now learning the dharma from vairocana these same deities proceed to teach him a more direct path to enlightenment through esoteric ritual the sutra then details the rituals used to actualize the dharma these rituals help forming the basis of esoteric ritual in shingon buddhism including such practices as meditating