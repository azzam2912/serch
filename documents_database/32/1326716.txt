in the episode andy learns his fiancee angela is having an affair with dwight and the two challenge each other to a physical fight to win her affections meanwhile michael travels to new york city for a meeting with david wallace where wallace seeks managerial advice from michael due to the poor financial condition of the fictional company dunder mifflin the episode was written by jennifer celotta and directed by dean holland the show s long time editor making his directorial debut it featured the conclusion of the love triangle between dwight andy and angela a subplot that had been going on since the end of the fourth season david wallace s meeting with michael marked the show s first acknowledgment of the economic crisis facing much of the globalized nation at the time of the episode due to the financial crisis of 2007 2010 the duel was seen as a defining episode for andy bernard who is portrayed in a more sympathetic way than he has been seen in previous episodes ed helms was particularly praised for his performance several bits of dialogue were improvised especially during the duel scene between andy and dwight that scene was shot over