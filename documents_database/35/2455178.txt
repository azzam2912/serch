it received the current form in the 14th century when bernab visconti lord of milan enlarged the existing fortification as part of a defensive system of the visconti dominions on the adda river at the end of the 20th century after a period of abandonment it was restored and transformed into a hotel the visconti castle is located near the adda river on a hill over the muzza canal the overlooking position allowing the control of the river is believed to have motivated the erection of the first fortification a castle in the area is supposed to have existed since the carolingean time near the castle on 27 september 1259 the battle of cassano was fought between the two milanese factions supporting ezzelino da romano and martino della torre the battle ended with the defeat of ezzelino and the confirmation of the della torre family as lords of milan the castle was acquired by the visconti house after their victory over the della torre in the fight for the lordship of milan in 1355 it was assigned to bernab within the division among him and his brothers matteo ii and galeazzo ii between 1355 e 1370 bernab who had received