it is based on the 3 dimensional spectral domain method kastner 1987 specialized to triply periodic media this technique uses the method of moments mom in combination with a bloch wave expansion of the electromagnetic field to yield a matrix eigenvalue equation for the propagation bands the eigenvalue is the frequency for a given propagation constant and the eigenvector is the set of current amplitudes on the surface of the scatterers bloch wave mom is similar in principle to the plane wave expansion method but since it additionally employs the method of moments to produce a surface integral equation it is significantly more efficient both in terms of the number of unknowns and the number of plane waves needed for good convergence bloch wave mom is the extension to 3 dimensions of the spectral domain mom method commonly used for analyzing 2d periodic structures such as frequency selective surfaces fss in both cases the field is expanded as a set of eigenfunction modes either a bloch wave in 3d or a discrete plane wave aka floquet mode spectrum in 2d and an integral equation is enforced on the surface of the scatterers in each unit cell in the fss case